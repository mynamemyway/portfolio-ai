# План реализации API-сервиса для модели эмбеддингов

## Этап 1: Создание и настройка проекта

**Задача:** Подготовить структуру каталогов и базовые файлы для нового сервиса.

1.  **Создать корневую директорию для сервиса:**
    - В корне основного репозитория создадим папку `embedding_service`.

2.  **Определить структуру проекта внутри `embedding_service`:**
    ```
    embedding_service/
    ├── app/
    │   ├── __init__.py
    │   ├── main.py         # Код FastAPI приложения
    │   └── models.py       # Pydantic модели для запросов/ответов
    ├── requirements.txt    # Зависимости Python
    └── Dockerfile          # Инструкции для сборки Docker-образа
    ```

## Этап 2: Реализация FastAPI-приложения

**Задача:** Написать код, который будет загружать модель и предоставлять эндпоинт для векторизации текста.

1.  **Определить зависимости в `requirements.txt`:**
    - `fastapi`: веб-фреймворк.
    - `uvicorn[standard]`: ASGI-сервер для запуска FastAPI.
    - `sentence-transformers`: библиотека для работы с embedding-моделями.
    - `pydantic`: для валидации данных.

2.  **Создать Pydantic-модели в `app/models.py`:**
    - `EmbeddingRequest`: модель для входящего запроса, содержащая поле `texts` (список строк).
    - `EmbeddingResponse`: модель для ответа, содержащая поле `embeddings` (список списков float).

3.  **Написать основную логику в `app/main.py`:**
    - Инициализировать FastAPI-приложение.
    - Реализовать логику загрузки `sentence-transformers` модели. Модель должна загружаться один раз при старте приложения для экономии ресурсов.
    - Создать эндпоинт `POST /embed`, который:
        - Принимает `EmbeddingRequest`.
        - Вызывает метод `model.encode()` для векторизации текстов.
        - Возвращает `EmbeddingResponse` с полученными векторами.

## Этап 3: Контейнеризация сервиса с помощью Docker

**Задача:** Создать `Dockerfile` для сборки изолированного и переносимого образа сервиса.

1.  **Написать `Dockerfile`:**
    - Использовать официальный базовый образ Python (например, `python:3.12-slim`).
    - Установить системные зависимости, если потребуется.
    - Скопировать `requirements.txt` и установить зависимости Python. Это кэширует слой с зависимостями.
    - Скопировать код приложения (`app` директорию).
    - Определить команду для запуска приложения через `uvicorn` (`CMD`).
    - Указать порт, который будет открыт (`EXPOSE`).