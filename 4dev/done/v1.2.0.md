# Release v1.2.0: AI Core & Parser Refinement

–≠—Ç–æ—Ç —Ä–µ–ª–∏–∑ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫—Ä—É–ø–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ –Ω–∞ –ø–æ–≤—ã—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –æ—Ç–≤–µ—Ç–æ–≤ AI –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –≤ UX –∏ –ø–∞—Ä—Å–∏–Ω–≥–µ —Ä–∞–∑–º–µ—Ç–∫–∏. –ë—ã–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã —Ñ–∞–π–ª—ã –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π, –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–µ–Ω —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è –ø—Ä–∏–¥–∞–Ω–∏—è –±–æ—Ç—É –±–æ–ª–µ–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π —Ä–æ–ª–∏, –∞ —Ç–∞–∫–∂–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã –æ—à–∏–±–∫–∏ –≤ —Å–∞–Ω–∏—Ç–∞–π–∑–µ—Ä–µ Markdown –∏ –ª–æ–≥–∏–∫–µ —Ä–∞–±–æ—Ç—ã `inline`-–∫–Ω–æ–ø–æ–∫.

## üß† –£–ª—É—á—à–µ–Ω–∏—è AI –∏ –ö–æ–Ω—Ç–µ–Ω—Ç–∞

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π
*   **–ê–¥–∞–ø—Ç–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞:** –û–±–Ω–æ–≤–ª–µ–Ω—ã –∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ `app/knowledge_base`, –≤–∫–ª—é—á–∞—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ `portfolio_ai_bot_special_README.md`, –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã—Ö –∏ –ø–æ–ª–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤.

### 2. –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –ü—Ä–æ–º–ø—Ç-–∏–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥
*   **–ù–æ–≤–∞—è —Ä–æ–ª—å "–õ–∏—á–Ω—ã–π –ö–∞—Ä—å–µ—Ä–Ω—ã–π –ê–≥–µ–Ω—Ç":** –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –±—ã–ª –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ –±–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—É—é –≤–µ—Ä—Å–∏—é. –ù–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç –¥–∞–µ—Ç AI —Å—Ç—Ä–æ–≥–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Å—Ç–∏–ª—é –æ–±—â–µ–Ω–∏—è, –ø—Ä–æ–∞–∫—Ç–∏–≤–Ω–æ–º—É –≤–æ–≤–ª–µ—á–µ–Ω–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –¥–∏–∞–ª–æ–≥ –∏ –∞–∫—Ü–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –≤–Ω–∏–º–∞–Ω–∏—è –Ω–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –¥–µ—Ç–∞–ª—è—Ö, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã –±–æ–ª–µ–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏ –∏ "–ø—Ä–æ–¥–∞—é—â–∏–º–∏".

## üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Markdown-—Å–∞–Ω–∏—Ç–∞–π–∑–µ—Ä–∞
*   **–ü—Ä–æ–±–ª–µ–º–∞:** –í–æ–∑–Ω–∏–∫–∞–ª–∏ –æ—à–∏–±–∫–∏ `TelegramBadRequest: can't parse entities` –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç—ã, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ (`main_py`) –∏–ª–∏ –º–æ–Ω–æ—à–∏—Ä–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç (`` `code` ``).
*   **–†–µ—à–µ–Ω–∏–µ:** –í —Ñ—É–Ω–∫—Ü–∏–∏ `sanitize_for_telegram_markdown` –±—ã–ª–∏ –≤–Ω–µ—Å–µ–Ω—ã —Ç–æ—á–µ—á–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏:
    1.  –°–∏–º–≤–æ–ª `_` –±—ã–ª –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Å–ø–∏—Å–æ–∫ —ç–∫—Ä–∞–Ω–∏—Ä—É–µ–º—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤, —á—Ç–æ–±—ã –æ–Ω –Ω–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞–ª—Å—è –∫–∞–∫ –Ω–∞—á–∞–ª–æ *–∫—É—Ä—Å–∏–≤–∞*.
    2.  –°–∏–º–≤–æ–ª –æ–±—Ä–∞—Ç–Ω–æ–π –∫–∞–≤—ã—á–∫–∏ `` ` `` –±—ã–ª —É–¥–∞–ª–µ–Ω –∏–∑ —Å–ø–∏—Å–∫–∞ —ç–∫—Ä–∞–Ω–∏—Ä—É–µ–º—ã—Ö, —á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ `–º–æ–Ω–æ—à–∏—Ä–∏–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞`.

### 2. –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –±–∞–≥–∞ —Å –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏–µ–º –∫–Ω–æ–ø–æ–∫
*   **–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∫–Ω–æ–ø–∫–∏ "–û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é" –∏–∑ –º–µ–Ω—é `/help` –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —É –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –∏—Å—á–µ–∑–∞–ª–∞, –±–ª–æ–∫–∏—Ä—É—è –¥–æ—Å—Ç—É–ø –∫ –¥—Ä—É–≥–∏–º –æ–ø—Ü–∏—è–º.
*   **–†–µ—à–µ–Ω–∏–µ:** –ò–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ `reset_chat` –±—ã–ª–∞ —É–¥–∞–ª–µ–Ω–∞ —Å—Ç—Ä–æ–∫–∞ `query.message.edit_reply_markup(reply_markup=None)`. –¢–µ–ø–µ—Ä—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∞ –º–µ—Å—Ç–µ, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π –∏ —É–¥–æ–±–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç.

### 3. –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è —Ñ–æ–ª–±—ç–∫-–º–µ—Ö–∞–Ω–∏–∑–º–∞
*   **–ü—Ä–æ–±–ª–µ–º–∞:** –í –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö –º–µ—Ç–æ–¥–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–µ—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ (`escape_markdown_v2` –∏ `parse_mode=None`), —á—Ç–æ —É—Å–ª–æ–∂–Ω—è–ª–æ –ª–æ–≥–∏–∫—É.
*   **–†–µ—à–µ–Ω–∏–µ:** –õ–æ–≥–∏–∫–∞ –±—ã–ª–∞ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞. –¢–µ–ø–µ—Ä—å –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ —Å–±–æ—è –ø–∞—Ä—Å–∏–Ω–≥–∞ Markdown –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π, –±–æ–ª–µ–µ –Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ —Å `parse_mode=None`.

## –†–µ–∑—É–ª—å—Ç–∞—Ç

–í–Ω–µ–¥—Ä–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–≤—ã—à–∞—é—Ç –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—É—é —Ü–µ–Ω–Ω–æ—Å—Ç—å –±–æ—Ç–∞, –¥–µ–ª–∞—è –µ–≥–æ –æ—Ç–≤–µ—Ç—ã –±–æ–ª–µ–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–º–∏ –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤ –ø–∞—Ä—Å–µ—Ä–µ –∏ UI –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω—É—é –∏ –Ω–∞–¥–µ–∂–Ω—É—é —Ä–∞–±–æ—Ç—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.